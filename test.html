<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù…Ù†ØµØ© Ø§Ù„Ù…Ø¹Ù„Ù… ÙˆØ§Ù„Ø·Ø§Ù„Ø¨ - Ù†Ø³Ø®Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-body: #020617;
      --bg-soft: #020617;
      --bg-elevated: #020617;
      --bg-card: #020617;
      --bg-app: radial-gradient(circle at top left, #1d4ed8 0, transparent 55%),
        radial-gradient(circle at bottom right, #a855f7 0, transparent 55%),
        #020617;
      --border-subtle: rgba(148, 163, 184, 0.35);
      --border-strong: rgba(148, 163, 184, 0.6);
      --accent: #6366f1;
      --accent-soft: rgba(99, 102, 241, 0.16);
      --accent-strong: #4f46e5;
      --accent-subtle: rgba(129, 140, 248, 0.2);
      --text-main: #e5e7eb;
      --text-soft: #cbd5f5;
      --text-muted: #9ca3af;
      --text-faint: #6b7280;
      --danger: #ef4444;
      --radius-xl: 22px;
      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-pill: 999px;
      --shadow-soft: 0 22px 55px rgba(15, 23, 42, 0.9);
      --shadow-card: 0 18px 35px rgba(15, 23, 42, 0.8);
      --shadow-subtle: 0 1px 0 rgba(148, 163, 184, 0.35);
      --transition-fast: 160ms ease-out;
      --transition-med: 220ms ease-out;
      --divider: rgba(148, 163, 184, 0.3);
      --chip-bg: rgba(15, 23, 42, 0.7);
    }

    /* Ø«ÙŠÙ… ÙØ§ØªØ­ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) */
    body[data-theme="light"] {
      --bg-body: #f3f4f6;
      --bg-soft: #e5e7eb;
      --bg-elevated: #ffffff;
      --bg-card: #ffffff;
      --bg-app: radial-gradient(circle at top left, #93c5fd 0, transparent 55%),
        radial-gradient(circle at bottom right, #e9d5ff 0, transparent 55%),
        #eef2ff;
      --border-subtle: rgba(148, 163, 184, 0.35);
      --border-strong: rgba(148, 163, 184, 0.6);
      --accent: #4f46e5;
      --accent-soft: rgba(79, 70, 229, 0.12);
      --accent-strong: #3730a3;
      --accent-subtle: rgba(79, 70, 229, 0.14);
      --text-main: #111827;
      --text-soft: #1f2937;
      --text-muted: #6b7280;
      --text-faint: #9ca3af;
      --shadow-soft: 0 22px 55px rgba(15, 23, 42, 0.15);
      --shadow-card: 0 18px 35px rgba(15, 23, 42, 0.12);
      --divider: rgba(148, 163, 184, 0.4);
      --chip-bg: rgba(255, 255, 255, 0.7);
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        "Cairo", sans-serif;
      background: var(--bg-body);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .app {
      position: relative;
      width: 100%;
      max-width: 880px;
      min-height: min(620px, 100vh - 48px);
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 0;
      padding: 26px 26px 24px;
      border-radius: var(--radius-xl);
      background: var(--bg-app);
      border: 1px solid rgba(148, 163, 184, 0.5);
      box-shadow: var(--shadow-soft);
      overflow: hidden;
      isolation: isolate;
    }

    .app::before,
    .app::after {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0.45;
      mix-blend-mode: screen;
      background:
        radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.12) 0, transparent 55%),
        radial-gradient(circle at 100% 0, rgba(129, 140, 248, 0.18) 0, transparent 50%),
        radial-gradient(circle at 100% 100%, rgba(244, 114, 182, 0.16) 0, transparent 55%);
      z-index: -1;
    }

    .app-left,
    .app-right {
      position: relative;
      z-index: 1;
    }

    .app-left {
      padding: 8px 8px 4px 4px;
      display: flex;
      flex-direction: column;
      gap: 18px;
      color: var(--text-soft);
    }

    .app-right {
      padding: 8px 8px 4px;
      border-radius: var(--radius-lg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      background: linear-gradient(
          145deg,
          rgba(15, 23, 42, 0.88),
          rgba(15, 23, 42, 0.96)
        );
      border: 1px solid rgba(148, 163, 184, 0.45);
      box-shadow: var(--shadow-card);
      display: flex;
      flex-direction: column;
    }

    body[data-theme="light"] .app-right {
      background: linear-gradient(
          145deg,
          rgba(255, 255, 255, 0.92),
          rgba(249, 250, 251, 0.98)
        );
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      background: rgba(15, 23, 42, 0.85);
      border: 1px solid rgba(148, 163, 184, 0.6);
      box-shadow: var(--shadow-subtle);
      font-size: 12px;
      color: var(--text-muted);
    }

    body[data-theme="light"] .badge {
      background: rgba(255, 255, 255, 0.9);
    }

    .badge-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #bbf7d0, #22c55e);
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.18);
    }

    .title {
      font-size: 30px;
      font-weight: 800;
      letter-spacing: -0.03em;
      color: #e5e7eb;
      margin-top: 8px;
    }

    .subtitle {
      margin-top: 5px;
      font-size: 14px;
      line-height: 1.8;
      color: var(--text-muted);
      max-width: 90%;
    }

    .pill-row {
      margin-top: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      font-size: 12px;
      color: var(--text-soft);
      border-radius: var(--radius-pill);
      background: rgba(15, 23, 42, 0.72);
      border: 1px solid rgba(148, 163, 184, 0.55);
    }

    body[data-theme="light"] .pill {
      background: rgba(255, 255, 255, 0.9);
    }

    .pill-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
    }

    .panel {
      margin-top: 12px;
      padding: 12px 14px;
      border-radius: var(--radius-lg);
      background: rgba(15, 23, 42, 0.85);
      border: 1px solid rgba(148, 163, 184, 0.55);
      box-shadow: var(--shadow-subtle);
    }

    body[data-theme="light"] .panel {
      background: rgba(255, 255, 255, 0.98);
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 4px;
    }

    .panel-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-soft);
    }

    .panel-tag {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: var(--radius-pill);
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
      white-space: nowrap;
    }

    body[data-theme="light"] .panel-tag {
      background: rgba(249, 250, 251, 0.95);
    }

    .hint {
      font-size: 13px;
      line-height: 1.8;
      color: var(--text-muted);
    }

    .code-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 8px;
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      background: rgba(15, 23, 42, 0.9);
      color: #a5b4fc;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      border: 1px dashed rgba(129, 140, 248, 0.7);
    }

    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 4px 2px 12px;
      margin-bottom: 6px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.45);
    }

    .topbar-logo {
      font-weight: 700;
      letter-spacing: 0.06em;
      font-size: 15px;
      text-transform: uppercase;
      color: #e5e7eb;
    }

    .topbar-logo span {
      color: #a5b4fc;
    }

    body[data-theme="light"] .topbar-logo {
      color: #111827;
    }

    .topbar-actions {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .topbar-theme-toggle {
      border-radius: var(--radius-pill);
      border: 1px solid rgba(148, 163, 184, 0.55);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-soft);
      font-size: 11px;
      padding: 4px 10px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: background var(--transition-fast), border-color var(--transition-fast),
        transform var(--transition-fast), box-shadow var(--transition-fast);
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.2);
    }

    body[data-theme="light"] .topbar-theme-toggle {
      background: rgba(255, 255, 255, 0.95);
    }

    .topbar-theme-toggle:hover {
      background: rgba(30, 64, 175, 0.9);
      border-color: #818cf8;
      transform: translateY(-1px);
      box-shadow: 0 10px 25px rgba(30, 64, 175, 0.45);
    }

    body[data-theme="light"] .topbar-theme-toggle:hover {
      background: #4f46e5;
      color: #e5e7eb;
    }

    .section {
      display: none;
      padding: 4px 2px 0;
    }

    .section.active {
      display: block;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-soft);
    }

    .section-subtitle {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 2px;
      max-width: 260px;
      line-height: 1.7;
    }

    .pill-soft {
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      background: rgba(15, 23, 42, 0.9);
      color: #c7d2fe;
      font-size: 11px;
      border: 1px solid rgba(129, 140, 248, 0.7);
      white-space: nowrap;
    }

    body[data-theme="light"] .pill-soft {
      background: rgba(255, 255, 255, 0.95);
      color: #4338ca;
    }

    .divider {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 14px 0 12px;
      color: var(--text-faint);
      font-size: 11px;
    }

    .divider-line {
      flex: 1;
      height: 1px;
      background: linear-gradient(
        90deg,
        transparent,
        var(--divider),
        transparent
      );
    }

    .btn-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .btn {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      border-radius: var(--radius-md);
      border: 1px solid transparent;
      padding: 9px 12px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: background var(--transition-med), border-color var(--transition-med),
        box-shadow var(--transition-med), transform var(--transition-fast);
      color: inherit;
      background: transparent;
    }

    .btn-full {
      width: 100%;
    }

    .btn-sm {
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 999px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      border-color: #6366f1;
      color: #e5e7eb;
      box-shadow: 0 12px 30px rgba(79, 70, 229, 0.5);
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #4338ca, #4f46e5);
      transform: translateY(-1px);
      box-shadow: 0 16px 40px rgba(79, 70, 229, 0.65);
    }

    .btn-ghost {
      background: rgba(15, 23, 42, 0.8);
      border-color: rgba(148, 163, 184, 0.6);
      color: var(--text-soft);
    }

    body[data-theme="light"] .btn-ghost {
      background: rgba(255, 255, 255, 0.95);
    }

    .btn-ghost:hover {
      background: rgba(15, 23, 42, 0.85);
      border-color: rgba(148, 163, 184, 0.85);
      transform: translateY(-1px);
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 10px;
      border-radius: var(--radius-pill);
      font-size: 11px;
      border: 1px solid transparent;
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-soft);
    }

    .tag-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2);
    }

    .tag-role-student {
      border-color: rgba(59, 130, 246, 0.7);
      background: radial-gradient(circle at 0 0, rgba(59, 130, 246, 0.3), transparent 55%),
        rgba(15, 23, 42, 0.96);
    }

    .tag-role-teacher {
      border-color: rgba(244, 114, 182, 0.7);
      background: radial-gradient(circle at 0 0, rgba(244, 114, 182, 0.3), transparent 55%),
        rgba(15, 23, 42, 0.96);
    }

    .profile-card {
      margin-top: 8px;
      padding: 12px 12px 10px;
      border-radius: var(--radius-lg);
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      box-shadow: var(--shadow-subtle);
    }

    body[data-theme="light"] .profile-card {
      background: rgba(255, 255, 255, 0.98);
    }

    .profile-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 700;
      background: radial-gradient(circle at 0 0, #22d3ee, #4f46e5);
      color: white;
      box-shadow: 0 12px 30px rgba(59, 130, 246, 0.6);
    }

    .profile-meta {
      font-size: 12px;
      color: var(--text-faint);
    }

    .profile-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-top: 8px;
    }

    .profile-item-label {
      font-size: 11px;
      color: var(--text-faint);
      margin-bottom: 2px;
    }

    .profile-item-value {
      font-size: 13px;
      color: var(--text-soft);
      font-weight: 500;
    }

    .empty-state {
      padding: 10px 10px 9px;
      border-radius: var(--radius-md);
      background: rgba(15, 23, 42, 0.92);
      border: 1px dashed rgba(148, 163, 184, 0.7);
      color: var(--text-muted);
      font-size: 12px;
      margin-top: 8px;
    }

    body[data-theme="light"] .empty-state {
      background: rgba(255, 255, 255, 0.98);
    }

    .courses-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 6px;
    }

    .course-card {
      padding: 9px 10px 8px;
      border-radius: var(--radius-md);
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      box-shadow: 0 10px 22px rgba(15, 23, 42, 0.8);
    }

    body[data-theme="light"] .course-card {
      background: rgba(255, 255, 255, 0.98);
    }

    .course-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-soft);
      margin-bottom: 4px;
    }

    .course-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 11px;
      color: var(--text-faint);
      margin-bottom: 4px;
    }

    .course-desc {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.7;
      margin-bottom: 6px;
    }

    .course-video iframe {
      width: 100%;
      height: 165px;
      border-radius: 12px;
      border: none;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.8);
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
      margin-bottom: 6px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 6px;
    }

    .field label {
      font-size: 11px;
      color: var(--text-faint);
    }

    .field input,
    .field textarea,
    .field select {
      border-radius: 9px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.88);
      color: var(--text-soft);
      font-size: 13px;
      padding: 6px 8px;
      outline: none;
      transition: border-color var(--transition-fast), box-shadow var(--transition-fast),
        background var(--transition-fast), transform var(--transition-fast);
      resize: vertical;
      min-height: 32px;
    }

    body[data-theme="light"] .field input,
    body[data-theme="light"] .field textarea,
    body[data-theme="light"] .field select {
      background: rgba(255, 255, 255, 0.98);
    }

    .field input:focus,
    .field textarea:focus,
    .field select:focus {
      border-color: #818cf8;
      box-shadow: 0 0 0 1px rgba(129, 140, 248, 0.7);
      transform: translateY(-0.5px);
    }

    .helper {
      font-size: 11px;
      color: var(--text-faint);
      margin-top: 2px;
    }

    .success {
      margin: 6px 0;
      padding: 6px 9px;
      border-radius: 10px;
      font-size: 12px;
      background: rgba(22, 163, 74, 0.1);
      color: #bbf7d0;
      border: 1px solid rgba(34, 197, 94, 0.8);
    }

    body[data-theme="light"] .success {
      background: rgba(22, 163, 74, 0.06);
      color: #15803d;
    }

    .hidden {
      display: none !important;
    }

    @media (max-width: 1000px) {
      .app {
        grid-template-columns: 1fr;
        min-height: auto;
        padding: 20px 16px 18px;
      }

      .subtitle {
        max-width: 100%;
      }

      .app-right {
        margin-top: 8px;
      }
    }

    @media (max-width: 640px) {
      body {
        padding: 12px;
      }

      .app {
        border-radius: 18px;
      }

      .section-header {
        align-items: flex-start;
      }

      .profile-grid,
      .form-row {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
</head>
<body data-theme="dark">
  <div class="app">
    <div class="app-right">
      <div class="topbar">
        <div class="topbar-logo">
          EDU<span>Connect</span>
        </div>
        <div class="topbar-actions">
          <button id="themeToggle" class="topbar-theme-toggle" type="button">
            Ø«ÙŠÙ… Ø¯Ø§ÙƒÙ†
          </button>
          <button id="logoutBtn" class="topbar-theme-toggle" type="button" style="display:none;">
            ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
          </button>
        </div>
      </div>

      <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ -->
      <section id="section-auth" class="section active">
        <div class="section-header">
          <div>
            <div class="section-title">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ğŸ‘‹</div>
            <div class="section-subtitle">
              Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø§Ù„Ù…Ø¹Ù„Ù….
            </div>
          </div>
        </div>

        <div class="btn-group" style="margin-bottom:10px;">
          <button id="authShowLogin" class="btn btn-primary btn-sm" type="button">
            ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
          </button>
          <button id="authShowRegister" class="btn btn-ghost btn-sm" type="button">
            Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
          </button>
        </div>

        <div id="authError" class="empty-state hidden"></div>

        <form id="loginForm" class="panel" style="margin-top:8px;">
          <div class="panel-header">
            <div class="panel-title">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</div>
          </div>
          <div class="field">
            <label for="loginEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input id="loginEmail" type="email" required />
          </div>
          <div class="field">
            <label for="loginPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <input id="loginPassword" type="password" required />
          </div>
          <div class="btn-group" style="margin-top:8px;">
            <button class="btn btn-primary btn-full" type="submit">
              Ø¯Ø®ÙˆÙ„
            </button>
          </div>
        </form>

        <form id="registerForm" class="panel hidden" style="margin-top:8px;">
          <div class="panel-header">
            <div class="panel-title">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</div>
          </div>
          <div class="form-row">
            <div class="field">
              <label for="registerFullName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ</label>
              <input id="registerFullName" required />
            </div>
            <div class="field">
              <label for="registerPhone">Ø±Ù‚Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†</label>
              <input id="registerPhone" required />
            </div>
          </div>
          <div class="field">
            <label for="registerEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input id="registerEmail" type="email" required />
          </div>
          <div class="field">
            <label for="registerPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <input id="registerPassword" type="password" required />
          </div>
          <div class="field">
            <label for="registerRole">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨</label>
            <select id="registerRole" required>
              <option value="student">Ø·Ø§Ù„Ø¨</option>
              <option value="teacher">Ù…Ø¹Ù„Ù…</option>
            </select>
          </div>

          <div id="registerStudentFields">
            <div class="form-row">
              <div class="field">
                <label for="registerStudentStage">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
                <select id="registerStudentStage" required>
                  <option value="Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                  <option value="Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ">Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
                  <option value="Ø«Ø§Ù†ÙˆÙŠ">Ø«Ø§Ù†ÙˆÙŠ</option>
                  <option value="Ø¬Ø§Ù…Ø¹ÙŠ">Ø¬Ø§Ù…Ø¹ÙŠ</option>
                </select>
              </div>
              <div class="field">
                <label for="registerStudentTerm">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                <select id="registerStudentTerm" required>
                  <option value="Ø§Ù„Ø£ÙˆÙ„">Ø§Ù„Ø£ÙˆÙ„</option>
                  <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ">Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                  <option value="Ø³Ù†ÙˆÙŠ">Ø³Ù†ÙˆÙŠ ÙƒØ§Ù…Ù„</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label for="registerStudentYear">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
              <select id="registerStudentYear" required></select>
            </div>
          </div>

          <div id="registerTeacherFields" class="hidden">
            <div class="field">
              <label for="registerTeacherSubject">Ø§Ù„Ù…Ø§Ø¯Ø©</label>
              <select id="registerTeacherSubject" required>
                <option>Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option>Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                <option>Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
                <option>Ø§Ù„Ø£Ø­ÙŠØ§Ø¡</option>
                <option>Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡</option>
                <option>Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡</option>
                <option>Ø§Ù„Ø¹Ù„ÙˆÙ…</option>
                <option>Ø§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</option>
                <option>Ø§Ù„ØªØ§Ø±ÙŠØ®</option>
                <option>Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§</option>
                <option>Ø§Ù„Ø¥Ø­ØµØ§Ø¡</option>
                <option>Ø§Ù„Ù„ØºØ© Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©</option>
              </select>
            </div>
          </div>

          <div class="btn-group" style="margin-top:8px;">
            <button class="btn btn-primary btn-full" type="submit">
              Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
            </button>
          </div>
        </form>
      </section>

      <!-- Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø·Ø§Ù„Ø¨ (Ù„Ø§ ØªØºÙŠÙŠØ± ÙÙŠÙ‡Ø§) -->
      <section id="section-student-dashboard" class="section">
        <div class="section-header">
          <div>
            <div class="section-title">Ù…Ø±Ø­Ø¨Ø§ ÙŠØ§ Ø¨Ø·Ù„ ğŸ‘¨â€ğŸ“</div>
            <div class="section-subtitle">
              Ù‡Ø°Ù‡ ØµÙØ­ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ ØªØ¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙˆØ§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù…Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©.
            </div>
          </div>
          <span class="tag tag-role-student">
            <span class="tag-dot"></span>
            Ø·Ø§Ù„Ø¨
          </span>
        </div>

        <div class="profile-card">
          <div class="profile-header">
            <div class="avatar" id="studentAvatar">ST</div>
            <div>
              <div id="studentNameDisplay" style="font-weight:600;"></div>
              <div class="profile-meta" id="studentEmailDisplay"></div>
            </div>
          </div>
          <div class="profile-grid">
            <div>
              <div class="profile-item-label">Ø§Ù„Ù‡Ø§ØªÙ</div>
              <div class="profile-item-value" id="studentPhoneDisplay"></div>
            </div>
            <div>
              <div class="profile-item-label">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</div>
              <div class="profile-item-value" id="studentStageDisplay"></div>
            </div>
            <div>
              <div class="profile-item-label">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</div>
              <div class="profile-item-value" id="studentYearDisplay"></div>
            </div>
            <div>
              <div class="profile-item-label">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</div>
              <div class="profile-item-value" id="studentTermDisplay"></div>
            </div>
            <div>
              <div class="profile-item-label">Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</div>
              <button id="editStudentProfileBtn" class="btn btn-ghost btn-sm">
                ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
              </button>
            </div>
          </div>
        </div>

        <div id="studentEditFormWrapper" class="panel hidden">
          <div class="panel-header">
            <div class="panel-title">ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</div>
          </div>
          <form id="studentEditForm">
            <div class="form-row">
              <div class="field">
                <label for="editStudentName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ</label>
                <input id="editStudentName" required />
              </div>
              <div class="field">
                <label for="editStudentPhone">Ø±Ù‚Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†</label>
                <input id="editStudentPhone" required />
              </div>
            </div>
            <div class="form-row">
              <div class="field">
                <label for="editStudentStage">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
                <select id="editStudentStage" required>
                  <option value="Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                  <option value="Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ">Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
                  <option value="Ø«Ø§Ù†ÙˆÙŠ">Ø«Ø§Ù†ÙˆÙŠ</option>
                  <option value="Ø¬Ø§Ù…Ø¹ÙŠ">Ø¬Ø§Ù…Ø¹ÙŠ</option>
                </select>
              </div>
              <div class="field">
                <label for="editStudentTerm">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                <select id="editStudentTerm" required>
                  <option value="Ø§Ù„Ø£ÙˆÙ„">Ø§Ù„Ø£ÙˆÙ„</option>
                  <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ">Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                  <option value="Ø³Ù†ÙˆÙŠ">Ø³Ù†ÙˆÙŠ ÙƒØ§Ù…Ù„</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label for="editStudentYear">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
              <select id="editStudentYear" required></select>
            </div>
            <div class="btn-group" style="margin-top:8px;">
              <button class="btn btn-primary btn-sm" type="submit">
                Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
              </button>
              <button class="btn btn-ghost btn-sm" type="button" id="cancelStudentEdit">
                Ø¥Ù„ØºØ§Ø¡
              </button>
            </div>
          </form>
        </div>

        <div class="panel" style="margin-top:8px;">
          <div class="panel-header">
            <div class="panel-title">Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ùƒ</div>
            <span id="studentCoursesTag" class="panel-tag"></span>
          </div>
          <div id="studentCoursesContainer" class="courses-list"></div>
          <div id="studentCoursesEmpty" class="empty-state hidden">
            Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙˆØ±Ø³Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù† Ù„Ù…Ø±Ø­Ù„ØªÙƒ. Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…Ø¹Ù„Ù…ÙˆÙ† Ø¨Ø¥Ø¶Ø§ÙØ©
            ÙƒÙˆØ±Ø³Ø§Øª Ù…ÙˆØ¬Ù‡Ø© Ù„Ù†ÙØ³ Ø§Ù„Ù…Ø±Ø­Ù„Ø© ÙˆØ§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØŒ Ø³ØªØ¸Ù‡Ø± Ù„Ùƒ Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.
          </div>
        </div>
      </section>

      <!-- Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¹Ù„Ù… (Ù„Ø§ ØªØºÙŠÙŠØ± ÙÙŠÙ‡Ø§) -->
      <section id="section-teacher-dashboard" class="section">
        <div class="section-header">
          <div>
            <div class="section-title">Ø£Ù‡Ù„Ø§Ù‹ Ø£Ø³ØªØ§Ø°Ù†Ø§ ğŸ‘¨â€ğŸ«</div>
            <div class="section-subtitle">
              Ù‡Ø°Ù‡ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙˆØ§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„ØªÙŠ ØªÙ‚Ø¯Ù…Ù‡Ø§.
            </div>
          </div>
          <span class="tag tag-role-teacher">
            <span class="tag-dot"></span>
            Ù…Ø¹Ù„Ù…
          </span>
        </div>

        <div class="profile-card">
          <div class="profile-header">
            <div class="avatar" id="teacherAvatar">TR</div>
            <div>
              <div id="teacherNameDisplay" style="font-weight:600;"></div>
              <div class="profile-meta" id="teacherEmailDisplay"></div>
            </div>
          </div>
          <div class="profile-grid">
            <div>
              <div class="profile-item-label">Ø§Ù„Ù‡Ø§ØªÙ</div>
              <div class="profile-item-value" id="teacherPhoneDisplay"></div>
            </div>
            <div>
              <div class="profile-item-label">Ø§Ù„Ù…Ø§Ø¯Ø©</div>
              <div class="profile-item-value" id="teacherSubjectDisplay"></div>
            </div>
            <div>
              <div class="profile-item-label">Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</div>
              <button id="editTeacherProfileBtn" class="btn btn-ghost btn-sm">
                ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
              </button>
            </div>
          </div>
        </div>

        <div id="teacherEditFormWrapper" class="panel hidden">
          <div class="panel-header">
            <div class="panel-title">ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…</div>
          </div>
          <form id="teacherEditForm">
            <div class="form-row">
              <div class="field">
                <label for="editTeacherName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ</label>
                <input id="editTeacherName" required />
              </div>
              <div class="field">
                <label for="editTeacherPhone">Ø±Ù‚Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†</label>
                <input id="editTeacherPhone" required />
              </div>
            </div>
            <div class="field">
              <label for="editTeacherSubject">Ø§Ù„Ù…Ø§Ø¯Ø©</label>
              <select id="editTeacherSubject" required>
                <option>Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option>Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                <option>Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
                <option>Ø§Ù„Ø£Ø­ÙŠØ§Ø¡</option>
                <option>Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡</option>
                <option>Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡</option>
                <option>Ø§Ù„Ø¹Ù„ÙˆÙ…</option>
                <option>Ø§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</option>
                <option>Ø§Ù„ØªØ§Ø±ÙŠØ®</option>
                <option>Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§</option>
                <option>Ø§Ù„Ø¥Ø­ØµØ§Ø¡</option>
                <option>Ø§Ù„Ù„ØºØ© Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©</option>
              </select>
            </div>
            <div class="btn-group" style="margin-top:8px;">
              <button class="btn btn-primary btn-sm" type="submit">
                Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
              </button>
              <button class="btn btn-ghost btn-sm" type="button" id="cancelTeacherEdit">
                Ø¥Ù„ØºØ§Ø¡
              </button>
            </div>
          </form>
        </div>

        <div class="panel" style="margin-top:10px;">
          <div class="panel-header">
            <div class="panel-title">Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ±Ø³ Ø¬Ø¯ÙŠØ¯</div>
          </div>
          <form id="courseForm">
            <div class="field">
              <label for="courseTitle">Ø§Ø³Ù… Ø§Ù„ÙƒÙˆØ±Ø³</label>
              <input
                id="courseTitle"
                required
                placeholder="Ù…Ø«Ø§Ù„: Ù†Ø­Ùˆ Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ"
              />
            </div>
            <div class="field">
              <label for="courseDescription">ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„ÙƒÙˆØ±Ø³</label>
              <textarea
                id="courseDescription"
                placeholder="Ù†Ø¨Ø°Ø© Ø³Ø±ÙŠØ¹Ø© Ø¹Ù† Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙƒÙˆØ±Ø³..."
              ></textarea>
            </div>
            <div class="form-row">
              <div class="field">
                <label for="courseStage">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</label>
                <select id="courseStage" required>
                  <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø­Ù„Ø©</option>
                  <option value="Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                  <option value="Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ">Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
                  <option value="Ø«Ø§Ù†ÙˆÙŠ">Ø«Ø§Ù†ÙˆÙŠ</option>
                  <option value="Ø¬Ø§Ù…Ø¹ÙŠ">Ø¬Ø§Ù…Ø¹ÙŠ</option>
                </select>
              </div>
              <div class="field">
                <label for="courseTerm">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                <select id="courseTerm" required>
                  <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØµÙ„</option>
                  <option value="Ø§Ù„Ø£ÙˆÙ„">Ø§Ù„Ø£ÙˆÙ„</option>
                  <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ">Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                  <option value="Ø³Ù†ÙˆÙŠ">Ø³Ù†ÙˆÙŠ ÙƒØ§Ù…Ù„</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label for="courseYear">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</label>
              <select id="courseYear" required></select>
            </div>
            <div class="field">
              <label for="courseVideoUrl">
                Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ (Ù…Ø«Ø§Ù„: Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨ - Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
              </label>
              <input
                id="courseVideoUrl"
                placeholder="https://www.youtube.com/embed/..."
              />
              <div class="helper">
                Ø¶Ø¹ Ø±Ø§Ø¨Ø· <strong>embed</strong> Ù„Ù„ÙŠÙˆØªÙŠÙˆØ¨ Ø¥Ø°Ø§ Ø±ØºØ¨Øª ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù†ØµØ© (Ù…Ø«Ù„
                <span dir="ltr">https://www.youtube.com/embed/ID</span>).
              </div>
            </div>
            <div id="courseMessage" class="success" style="display:none;"></div>
            <button class="btn btn-primary btn-full" type="submit">
              Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ±Ø³
            </button>
          </form>
        </div>

        <div class="panel" style="margin-top:10px;">
          <div class="panel-header">
            <div class="panel-title">Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨Ø¥Ø¶Ø§ÙØªÙ‡Ø§</div>
          </div>
          <div id="teacherCoursesContainer" class="courses-list"></div>
          <div id="teacherCoursesEmpty" class="empty-state">
            Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ ÙƒÙˆØ±Ø³Ø§Øª Ø¨Ø¹Ø¯. Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ ÙƒÙˆØ±Ø³ Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰.
          </div>
        </div>
      </section>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-analytics.js";
    import {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      onAuthStateChanged,
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
    import {
      getFirestore,
      doc,
      setDoc,
      getDoc,
      collection,
      addDoc,
      query,
      where,
      getDocs,
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDZDixgSbxP1eDaoDi63c06prvoQdfa67c",
      authDomain: "meem-b5e88.firebaseapp.com",
      projectId: "meem-b5e88",
      storageBucket: "meem-b5e88.firebasestorage.app",
      messagingSenderId: "135725169302",
      appId: "1:135725169302:web:a3574fb511f7f2d9b9e0b7",
      measurementId: "G-J2D5MF3MDC",
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Ù…ØªØºÙŠØ±Ø§Øª ØªØ­ÙƒÙ…
    let currentRole = "student"; // student | teacher
    let currentUser = null;

    const THEME_KEY = "edu-theme";

    function applyTheme(theme) {
      document.body.setAttribute("data-theme", theme);
      if (themeToggle) {
        themeToggle.textContent = theme === "dark" ? "Ø«ÙŠÙ… ÙØ§ØªØ­" : "Ø«ÙŠÙ… Ø¯Ø§ÙƒÙ†";
      }
    }

    function initTheme() {
      const saved = window.localStorage.getItem(THEME_KEY);
      const prefersDark =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      const initial = saved || (prefersDark ? "dark" : "light");
      applyTheme(initial);

      if (themeToggle) {
        themeToggle.addEventListener("click", () => {
          const current = document.body.getAttribute("data-theme") || "dark";
          const next = current === "dark" ? "light" : "dark";
          window.localStorage.setItem(THEME_KEY, next);
          applyTheme(next);
        });
      }
    }

    // Ø¹Ù†Ø§ØµØ± ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø·Ø§Ù„Ø¨/Ø§Ù„Ù…Ø¹Ù„Ù…
    const sectionAuth = document.getElementById("section-auth");
    const sectionStudentDashboard = document.getElementById("section-student-dashboard");
    const sectionTeacherDashboard = document.getElementById("section-teacher-dashboard");
    const themeToggle = document.getElementById("themeToggle");
    const logoutBtn = document.getElementById("logoutBtn");

    // Ø¹Ù†Ø§ØµØ± Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„/Ø§Ù„ØªØ³Ø¬ÙŠÙ„
    const authShowLogin = document.getElementById("authShowLogin");
    const authShowRegister = document.getElementById("authShowRegister");
    const authError = document.getElementById("authError");
    const loginForm = document.getElementById("loginForm");
    const registerForm = document.getElementById("registerForm");
    const loginEmail = document.getElementById("loginEmail");
    const loginPassword = document.getElementById("loginPassword");
    const registerFullName = document.getElementById("registerFullName");
    const registerPhone = document.getElementById("registerPhone");
    const registerEmail = document.getElementById("registerEmail");
    const registerPassword = document.getElementById("registerPassword");
    const registerRole = document.getElementById("registerRole");
    const registerStudentStage = document.getElementById("registerStudentStage");
    const registerStudentYear = document.getElementById("registerStudentYear");
    const registerStudentTerm = document.getElementById("registerStudentTerm");
    const registerTeacherSubject = document.getElementById("registerTeacherSubject");
    const registerStudentFields = document.getElementById("registerStudentFields");
    const registerTeacherFields = document.getElementById("registerTeacherFields");

    // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø·Ø§Ù„Ø¨
    const studentAvatar = document.getElementById("studentAvatar");
    const studentNameDisplay = document.getElementById("studentNameDisplay");
    const studentEmailDisplay = document.getElementById("studentEmailDisplay");
    const studentPhoneDisplay = document.getElementById("studentPhoneDisplay");
    const studentStageDisplay = document.getElementById("studentStageDisplay");
    const studentYearDisplay = document.getElementById("studentYearDisplay");
    const studentTermDisplay = document.getElementById("studentTermDisplay");
    const studentCoursesContainer = document.getElementById("studentCoursesContainer");
    const studentCoursesEmpty = document.getElementById("studentCoursesEmpty");
    const studentCoursesTag = document.getElementById("studentCoursesTag");
    const editStudentProfileBtn = document.getElementById("editStudentProfileBtn");
    const studentEditFormWrapper = document.getElementById("studentEditFormWrapper");
    const studentEditForm = document.getElementById("studentEditForm");
    const editStudentName = document.getElementById("editStudentName");
    const editStudentPhone = document.getElementById("editStudentPhone");
    const editStudentStage = document.getElementById("editStudentStage");
    const editStudentTerm = document.getElementById("editStudentTerm");
    const editStudentYear = document.getElementById("editStudentYear");
    const cancelStudentEdit = document.getElementById("cancelStudentEdit");

    // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¹Ù„Ù…
    const teacherAvatar = document.getElementById("teacherAvatar");
    const teacherNameDisplay = document.getElementById("teacherNameDisplay");
    const teacherEmailDisplay = document.getElementById("teacherEmailDisplay");
    const teacherPhoneDisplay = document.getElementById("teacherPhoneDisplay");
    const teacherSubjectDisplay = document.getElementById("teacherSubjectDisplay");
    const editTeacherProfileBtn = document.getElementById("editTeacherProfileBtn");
    const teacherEditFormWrapper = document.getElementById("teacherEditFormWrapper");
    const teacherEditForm = document.getElementById("teacherEditForm");
    const editTeacherName = document.getElementById("editTeacherName");
    const editTeacherPhone = document.getElementById("editTeacherPhone");
    const editTeacherSubject = document.getElementById("editTeacherSubject");
    const cancelTeacherEdit = document.getElementById("cancelTeacherEdit");
    const courseForm = document.getElementById("courseForm");
    const courseTitle = document.getElementById("courseTitle");
    const courseDescription = document.getElementById("courseDescription");
    const courseStage = document.getElementById("courseStage");
    const courseTerm = document.getElementById("courseTerm");
    const courseYear = document.getElementById("courseYear");
    const courseVideoUrl = document.getElementById("courseVideoUrl");
    const courseMessage = document.getElementById("courseMessage");
    const teacherCoursesContainer = document.getElementById("teacherCoursesContainer");
    const teacherCoursesEmpty = document.getElementById("teacherCoursesEmpty");

    function setActiveSection(section) {
      [
        sectionAuth,
        sectionStudentDashboard,
        sectionTeacherDashboard,
      ].forEach((s) => s && s.classList.remove("active"));
      if (section) {
        section.classList.add("active");
      }
    }

    function shortName(name) {
      if (!name) return "";
      const parts = name.trim().split(/\s+/);
      if (parts.length === 1) return parts[0][0]?.toUpperCase() || "";
      return (
        (parts[0][0] || "").toUpperCase() +
        (parts[1] ? (parts[1][0] || "").toUpperCase() : "")
      );
    }

    // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ / Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª
    async function renderStudentDashboard() {
      if (!currentUser || currentUser.role !== "student") return;

      studentAvatar.textContent = shortName(currentUser.fullName || "ST");
      studentNameDisplay.textContent = currentUser.fullName || "";
      studentEmailDisplay.textContent = currentUser.email || "";
      studentPhoneDisplay.textContent = currentUser.phone || "";
      studentStageDisplay.textContent = currentUser.stage || "-";
      studentYearDisplay.textContent = currentUser.year || "-";
      studentTermDisplay.textContent = currentUser.term || "-";

      studentCoursesTag.textContent =
        (currentUser.stage || "") +
        " - " +
        (currentUser.term || "") +
        (currentUser.year ? " - Ø§Ù„Ø³Ù†Ø© " + currentUser.year : "");

      // Ø¬Ù„Ø¨ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ù…Ù† Firestore Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±Ø­Ù„Ø©ØŒ Ø«Ù… Ø§Ù„ØªØµÙÙŠØ© Ø¨Ø§Ù„ÙØµÙ„ ÙˆØ§Ù„Ø³Ù†Ø© ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
      const q = query(
        collection(db, "courses"),
        where("stage", "==", currentUser.stage || "")
      );

      const snapshot = await getDocs(q);
      const filtered = [];
      snapshot.forEach((docSnap) => {
        const c = docSnap.data();
        const termMatch = c.term === currentUser.term;
        const yearMatch =
          !currentUser.year ||
          !c.year ||
          c.year === currentUser.year;
        if (termMatch && yearMatch) {
          filtered.push(c);
        }
      });

      studentCoursesContainer.innerHTML = "";
      if (filtered.length === 0) {
        studentCoursesEmpty.classList.remove("hidden");
      } else {
        studentCoursesEmpty.classList.add("hidden");
        filtered.forEach((c) => {
          const card = document.createElement("div");
          card.className = "course-card";
          card.innerHTML = `
            <div class="course-title">${c.title}</div>
            <div class="course-meta">
              <span>Ø§Ù„Ù…Ø±Ø­Ù„Ø©: ${c.stage}</span>
              <span>Ø§Ù„ÙØµÙ„: ${c.term}</span>
              ${c.year ? `<span>Ø§Ù„Ø³Ù†Ø©: ${c.year}</span>` : ""}
            </div>
            ${
              c.description
                ? `<div class="course-desc">${c.description}</div>`
                : ""
            }
            ${
              c.videoUrl
                ? `<div class="course-video"><iframe src="${c.videoUrl}" allowfullscreen></iframe></div>`
                : ""
            }
          `;
          studentCoursesContainer.appendChild(card);
        });
      }
    }

    // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù… / Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª
    async function renderTeacherDashboard() {
      if (!currentUser || currentUser.role !== "teacher") return;

      teacherAvatar.textContent = shortName(currentUser.fullName || "TR");
      teacherNameDisplay.textContent = currentUser.fullName || "";
      teacherEmailDisplay.textContent = currentUser.email || "";
      teacherPhoneDisplay.textContent = currentUser.phone || "";
      teacherSubjectDisplay.textContent = currentUser.subject || "-";

      const q = query(
        collection(db, "courses"),
        where("teacherId", "==", currentUser.id)
      );
      const snapshot = await getDocs(q);

      teacherCoursesContainer.innerHTML = "";
      if (snapshot.empty) {
        teacherCoursesEmpty.classList.remove("hidden");
      } else {
        teacherCoursesEmpty.classList.add("hidden");
        snapshot.forEach((docSnap) => {
          const c = docSnap.data();
          const card = document.createElement("div");
          card.className = "course-card";
          card.innerHTML = `
            <div class="course-title">${c.title}</div>
            <div class="course-meta">
              <span>Ø§Ù„Ù…Ø±Ø­Ù„Ø©: ${c.stage || "-"}</span>
              <span>Ø§Ù„ÙØµÙ„: ${c.term || "-"}</span>
              ${c.year ? `<span>Ø§Ù„Ø³Ù†Ø©: ${c.year}</span>` : ""}
            </div>
            ${
              c.description
                ? `<div class="course-desc">${c.description}</div>`
                : ""
            }
            ${
              c.videoUrl
                ? `<div class="course-video"><iframe src="${c.videoUrl}" allowfullscreen></iframe></div>`
                : ""
            }
          `;
          teacherCoursesContainer.appendChild(card);
        });
      }
    }

    // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
    function getYearOptionsForStage(stage) {
      switch (stage) {
        case "Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ":
          return ["Ø§Ù„Ø£ÙˆÙ„Ù‰", "Ø§Ù„Ø«Ø§Ù†ÙŠØ©", "Ø§Ù„Ø«Ø§Ù„Ø«Ø©", "Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©", "Ø§Ù„Ø®Ø§Ù…Ø³Ø©", "Ø§Ù„Ø³Ø§Ø¯Ø³Ø©"];
        case "Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ":
        case "Ø«Ø§Ù†ÙˆÙŠ":
          return ["Ø§Ù„Ø£ÙˆÙ„Ù‰", "Ø§Ù„Ø«Ø§Ù†ÙŠØ©", "Ø§Ù„Ø«Ø§Ù„Ø«Ø©"];
        case "Ø¬Ø§Ù…Ø¹ÙŠ":
          return ["Ø§Ù„Ø£ÙˆÙ„Ù‰", "Ø§Ù„Ø«Ø§Ù†ÙŠØ©", "Ø§Ù„Ø«Ø§Ù„Ø«Ø©", "Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©", "Ø§Ù„Ø®Ø§Ù…Ø³Ø©"];
        default:
          return [];
      }
    }

    function populateYearSelect(selectEl, stage, currentValue) {
      if (!selectEl) return;
      const options = getYearOptionsForStage(stage);
      selectEl.innerHTML = "";
      options.forEach((label, idx) => {
        const opt = document.createElement("option");
        opt.value = label;
        opt.textContent = "Ø§Ù„Ø³Ù†Ø© " + label;
        if (currentValue && currentValue === label) {
          opt.selected = true;
        } else if (!currentValue && idx === 0) {
          opt.selected = true;
        }
        selectEl.appendChild(opt);
      });
    }

    // ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„
    function showLogin() {
      if (!loginForm || !registerForm) return;
      loginForm.classList.remove("hidden");
      registerForm.classList.add("hidden");
      if (authError) authError.classList.add("hidden");
    }

    function showRegister() {
      if (!loginForm || !registerForm) return;
      loginForm.classList.add("hidden");
      registerForm.classList.remove("hidden");
      if (authError) authError.classList.add("hidden");
    }

    if (authShowLogin) {
      authShowLogin.addEventListener("click", (e) => {
        e.preventDefault();
        showLogin();
      });
    }

    if (authShowRegister) {
      authShowRegister.addEventListener("click", (e) => {
        e.preventDefault();
        showRegister();
      });
    }

    // ØªÙ‡ÙŠØ¦Ø© Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
    if (registerStudentStage && registerStudentYear) {
      populateYearSelect(registerStudentYear, registerStudentStage.value || "Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ");
      registerStudentStage.addEventListener("change", () => {
        populateYearSelect(registerStudentYear, registerStudentStage.value);
      });
    }

    if (courseStage && courseYear) {
      populateYearSelect(courseYear, courseStage.value || "Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ");
      courseStage.addEventListener("change", () => {
        populateYearSelect(courseYear, courseStage.value);
      });
    }

    // ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
    editStudentProfileBtn.addEventListener("click", () => {
      if (!currentUser) return;
      editStudentName.value = currentUser.fullName || "";
      editStudentPhone.value = currentUser.phone || "";
      editStudentStage.value = currentUser.stage || "Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ";
      editStudentTerm.value = currentUser.term || "Ø§Ù„Ø£ÙˆÙ„";
      populateYearSelect(
        editStudentYear,
        editStudentStage.value,
        currentUser.year || undefined
      );
      studentEditFormWrapper.classList.remove("hidden");
    });
    cancelStudentEdit.addEventListener("click", () => {
      studentEditFormWrapper.classList.add("hidden");
    });

    studentEditForm.addEventListener("submit", (e) => {
      e.preventDefault();
      if (!currentUser) return;
      currentUser.fullName = editStudentName.value.trim();
      currentUser.phone = editStudentPhone.value.trim();
      currentUser.stage = editStudentStage.value;
      currentUser.term = editStudentTerm.value;
      currentUser.year = editStudentYear.value;

      // ØªØ­Ø¯ÙŠØ« ÙÙŠ Firestore
      const ref = doc(db, "users", currentUser.id);
      setDoc(ref, currentUser, { merge: true })
        .then(() => {
          return renderStudentDashboard();
        })
        .then(() => {
          studentEditFormWrapper.classList.add("hidden");
        })
        .catch((err) => {
          console.error(err);
          alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨.");
        });
    });

    // ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…
    editTeacherProfileBtn.addEventListener("click", () => {
      if (!currentUser) return;
      editTeacherName.value = currentUser.fullName || "";
      editTeacherPhone.value = currentUser.phone || "";
      editTeacherSubject.value = currentUser.subject || "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©";
      teacherEditFormWrapper.classList.remove("hidden");
    });

    cancelTeacherEdit.addEventListener("click", () => {
      teacherEditFormWrapper.classList.add("hidden");
    });

    teacherEditForm.addEventListener("submit", (e) => {
      e.preventDefault();
      if (!currentUser) return;
      currentUser.fullName = editTeacherName.value.trim();
      currentUser.phone = editTeacherPhone.value.trim();
      currentUser.subject = editTeacherSubject.value;

      const ref = doc(db, "users", currentUser.id);
      setDoc(ref, currentUser, { merge: true })
        .then(() => renderTeacherDashboard())
        .then(() => {
          teacherEditFormWrapper.classList.add("hidden");
        })
        .catch((err) => {
          console.error(err);
          alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù….");
        });
    });

    // Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ±Ø³ Ø¬Ø¯ÙŠØ¯ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø¹Ù„Ù…
    courseForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      if (!currentUser || currentUser.role !== "teacher") return;

      const title = courseTitle.value.trim();
      if (!title) return;

      const newCourse = {
        teacherId: currentUser.id,
        title,
        description: courseDescription.value.trim(),
        stage: courseStage.value,
        term: courseTerm.value,
        year: courseYear.value,
        videoUrl: courseVideoUrl.value.trim(),
        createdAt: Date.now(),
      };

      try {
        await addDoc(collection(db, "courses"), newCourse);
        courseMessage.textContent = "ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ±Ø³ Ø¨Ù†Ø¬Ø§Ø­.";
        courseMessage.style.display = "block";
        courseForm.reset();
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø³Ù†Ø© Ø§Ù„ÙƒÙˆØ±Ø³ Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·
        populateYearSelect(courseYear, courseStage.value || "Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ");
        setTimeout(() => {
          courseMessage.style.display = "none";
        }, 1500);
        await renderTeacherDashboard();
      } catch (err) {
        console.error(err);
        courseMessage.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆØ±Ø³.";
        courseMessage.style.display = "block";
      }
    });

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    if (loginForm) {
      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        if (!loginEmail || !loginPassword) return;
        if (authError) authError.classList.add("hidden");
        try {
          await signInWithEmailAndPassword(
            auth,
            loginEmail.value.trim(),
            loginPassword.value
          );
        } catch (err) {
          console.error(err);
          if (authError) {
            authError.textContent =
              "ØªØ¹Ø°Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.";
            authError.classList.remove("hidden");
          }
        }
      });
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
    if (registerForm) {
      registerForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        if (!registerEmail || !registerPassword || !registerRole) return;
        if (authError) authError.classList.add("hidden");

        const role = registerRole.value;
        const fullName = registerFullName.value.trim();
        const phone = registerPhone.value.trim();

        try {
          const cred = await createUserWithEmailAndPassword(
            auth,
            registerEmail.value.trim(),
            registerPassword.value
          );

          const uid = cred.user.uid;
          const baseProfile = {
            id: uid,
            role,
            fullName,
            phone,
            email: cred.user.email,
          };

          let profile = baseProfile;
          if (role === "student") {
            profile = {
              ...baseProfile,
              stage: registerStudentStage.value,
              term: registerStudentTerm.value,
              year: registerStudentYear.value,
            };
          } else if (role === "teacher") {
            profile = {
              ...baseProfile,
              subject: registerTeacherSubject.value,
            };
          }

          await setDoc(doc(db, "users", uid), profile);
          registerForm.reset();
          showLogin();
        } catch (err) {
          console.error(err);
          if (authError) {
            authError.textContent =
              "ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ Ø±Ø¨Ù…Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ù‚Ø¨Ù„.";
            authError.classList.remove("hidden");
          }
        }
      });
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    if (logoutBtn) {
      logoutBtn.addEventListener("click", () => {
        signOut(auth).catch((err) => console.error(err));
      });
    }

    // Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        currentUser = null;
        if (logoutBtn) logoutBtn.style.display = "none";
        setActiveSection(sectionAuth);
        showLogin();
        return;
      }

      try {
        const ref = doc(db, "users", user.uid);
        const snap = await getDoc(ref);
        const data = snap.exists() ? snap.data() : {};
        currentUser = {
          id: user.uid,
          email: user.email,
          ...data,
        };

        if (logoutBtn) logoutBtn.style.display = "inline-flex";

        if (currentUser.role === "student") {
          await renderStudentDashboard();
          setActiveSection(sectionStudentDashboard);
        } else if (currentUser.role === "teacher") {
          await renderTeacherDashboard();
          setActiveSection(sectionTeacherDashboard);
        } else {
          setActiveSection(sectionAuth);
          showLogin();
        }
      } catch (err) {
        console.error(err);
        if (authError) {
          authError.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨.";
          authError.classList.remove("hidden");
        }
        setActiveSection(sectionAuth);
      }
    });

    // Ø¨Ø¯Ø£ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    setActiveSection(sectionAuth);
    showLogin();
    initTheme();
  </script>
</body>
</html>